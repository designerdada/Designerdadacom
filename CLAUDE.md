# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a minimal, SEO-optimized personal website template, built with React 18, TypeScript, Vite, and Tailwind CSS. The site features a centered single-column layout (544px max width), dark mode support, and an MDX-powered blog.

**Tech Stack:**
- React 18 with TypeScript
- Vite (build tool)
- Tailwind CSS v3 (styling)
- React Router v6 (routing)
- MDX (blog content)
- Radix UI (component primitives)
- Deployed on Vercel

## Fork Setup (For New Users)

When someone forks this repo, they need to customize these files:

### Configuration Files
- `src/config/site.ts` - Main site configuration (name, URL, author, social links)
- `src/scripts/site-config.js` - Same config for build scripts

### Personal Content
- `public/assets/profile.png` - Profile photo
- `public/assets/footer-signature.png` - Footer signature/logo
- `public/assets/og-images/` - Open Graph images
- `src/pages/Home.tsx` - Bio text
- `src/components/Header.tsx` - Name display

### Files with Hardcoded URLs (need search/replace)
Search and replace `designerdada.com` with their domain in:
- `src/App.tsx` (JSON-LD, meta tags)
- `src/pages/*.tsx` (page meta tags)
- `src/scripts/generate-prerender.js`
- `src/content/writing/*.mdx` (ogImage URLs in frontmatter)

### Environment Variables (Optional - for photography feature)
- Copy `.env.example` to `.env`
- Set `VITE_WORKER_API_URL` and `VITE_R2_PUBLIC_URL`

## Development Commands

```bash
# Install dependencies
npm install

# Run development server (opens at localhost:3000)
npm run dev

# Build for production
npm run build

# Preview production build
npm run preview

# Generate all build artifacts
npm run generate

# Generate MDX content index
npm run generate:mdx

# Generate sitemap
npm run generate:sitemap

# Generate llms.txt
npm run generate:llms
```

## Build Process

The build runs in this order:
1. **Generate**: Runs all generation scripts (MDX index, sitemap, llms.txt)
2. **Vite Build**: Creates production bundle in `/build` directory
3. **Prerender**: Generates static HTML for routes

## Architecture

### Content Management System

The site uses a custom MDX processing pipeline:

1. **MDX Files** (`/src/content/writing/*.mdx`): Blog articles with frontmatter
2. **Auto-generated Index** (`/src/content/writing/index.ts`): Generated by `scripts/generate-mdx-index.js` - NEVER edit manually
3. **Article Metadata** (`/src/data/articles.ts`): Manual registry of articles with id, title, and date
4. **MDX Loader** (`/src/utils/mdxLoader.ts`): Parses frontmatter and caches articles at runtime

**Required MDX frontmatter fields:**
- `title`: Article title
- `description`: SEO description
- `publishDate`: Format: DD.MMM.YYYY
- `author`: Author name
- `ogImage`: Open Graph image URL
- `keywords`: Comma-separated keywords

### Routing Structure

- `/` - Home page (Home.tsx)
- `/writing` - Blog listing (Writing.tsx)
- `/writing/:id` - Article detail pages (WritingDetail.tsx)
- `/favorites` - Curated favorites list (Favorites.tsx)
- `/photography` - Photo gallery (Photography.tsx) - optional

### Component Organization

- `/components/` - Main React components (Header, Footer, MailingList, etc.)
- `/components/ui/` - Radix UI wrapper components
- `/components/figma/` - Figma import components
- `/config/` - Site configuration
- `/pages/` - Top-level page components
- `/data/` - Static data files (articles.ts, favorites.ts)
- `/utils/` - Utility functions (MDX parsing, etc.)
- `/hooks/` - Custom React hooks
- `/scripts/` - Build scripts (sitemap, llms.txt, etc.)

### Vite Configuration

The `vite.config.ts` contains extensive import aliases to resolve versioned package imports (e.g., `lucide-react@0.487.0` â†’ `lucide-react`). This is required because some components may import packages with version numbers in the import path.

The alias `@` resolves to `./src`.

### Styling System

- **Tailwind CSS**: Utility-first CSS with custom configuration
- **Dark Mode**: Class-based (`darkMode: 'class'`)
- **Custom Font**: EB Garamond serif font
- **Custom Font Sizes**: 2.5xl (22px), 3.5xl (32px), 5.5xl (50px)
- **Max Width**: 544px centered layout throughout

### SEO Implementation

The site has comprehensive SEO:
- Open Graph and Twitter Card meta tags on all pages
- JSON-LD structured data (Person, Website, BlogPosting schemas)
- Article-specific metadata with publish/modified dates
- Canonical URLs
- Dynamic meta tags per page via react-helmet

## Development Guidelines

1. **Layout**: Use flexbox and grid by default. Only use absolute positioning when necessary.
2. **Code Quality**: Refactor as you go. Keep files small. Put helpers in separate files.
3. **SEO/AIO**: Use correct Open Graph and Twitter meta tags. Use appropriate JSON-LD schemas for each page type.
4. **Content Workflow**:
   - Add new articles as `.mdx` files in `/src/content/writing/`
   - Add article entry to `/src/data/articles.ts`
   - Run `npm run generate:mdx` to rebuild the content index
   - NEVER manually edit `/src/content/writing/index.ts`
5. **Documentation**: Keep minimal and consolidated. Don't create new .md files unless explicitly requested.
6. **Component Styling**: Some base components have default styling (gap, typography). Explicitly override these in your React components.

## Important Files

- `/src/config/site.ts` - Centralized site configuration
- `/src/scripts/site-config.js` - Build script configuration
- `/src/scripts/generate-mdx-index.js` - Auto-generates content index from MDX files
- `/src/scripts/generate-sitemap.js` - Generates sitemap.xml
- `/src/scripts/generate-llms-txt.js` - Generates llms.txt for AI crawlers
- `/src/scripts/generate-prerender.js` - Pre-renders static HTML
- `/src/content/writing/index.ts` - AUTO-GENERATED - do not edit manually

## Security Notes

- `.env` files are gitignored - never commit secrets
- `cloudflare-worker/.dev.vars` is gitignored - use `.dev.vars.example` as template
- All API keys and tokens should be set via environment variables
- R2 bucket URLs and account IDs are now configurable via environment variables

## Deployment

The site is configured for Vercel with zero-config deployment:
- Build command: `npm run build`
- Output directory: `build`
- Vercel automatically runs all build scripts

## Common Tasks

### Adding a New Blog Article

1. Create `/src/content/writing/new-article-slug.mdx` with required frontmatter
2. Add entry to `/src/data/articles.ts` with matching id
3. Run `npm run generate:mdx`
4. Articles auto-sort by date (newest first)

### Modifying Page SEO

Update meta tags and JSON-LD in the page component using react-helmet. Follow the pattern in existing pages (Home.tsx, WritingDetail.tsx).

### Adding a New Page

1. Create page component in `/src/pages/`
2. Add route in `/src/App.tsx`
3. Add meta tags and JSON-LD structured data
4. Update sitemap generation script if needed

### Setting Up Photography Feature (Optional)

See `cloudflare-worker/README.md` for Cloudflare R2 and Worker setup.
